<!-- /modules/kalender.html -->
<section class="calendar">
  <div class="top">
    <button id="prevBtn" aria-label="Vorheriger Monat">‹</button>
    <h2 id="monthTitle" style="margin:0; font-size:18px;">Monat</h2>
    <button id="nextBtn" aria-label="Nächster Monat">›</button>

    <div style="margin-left:auto; display:flex; gap:8px; align-items:center;">
      <select id="teamFilter" aria-label="Teamfilter">
        <option value="">Alle Teams</option>
      </select>
      <select id="typeFilter" aria-label="Typfilter">
        <option value="">Alle Arten</option>
        <option value="training">Training</option>
        <option value="spiel">Spiel</option>
        <option value="camp">Camp</option>
        <option value="3x3">3x3</option>
        <option value="sonstiges">Sonstiges</option>
      </select>
    </div>
  </div>

  <!-- Kalenderraster -->
  <div id="calendarGrid" class="grid" aria-live="polite"></div>
</section>

<!-- Popup-Dialog für Event-Details -->
<div class="dialog" id="eventDialog">
  <div class="card">
    <button class="close-btn" onclick="closeDialog()">×</button>
    <h3 id="eventTitle">Titel</h3>
    <p id="eventDate" class="muted"></p>
    <p id="eventDescription"></p>

    <hr style="margin:16px 0; border:1px solid var(--border);" />

    <a href="modules/anmeldung.html" id="eventSignupLink" class="button">
      Zur Anmeldung
    </a>
  </div>
</div>

<script>
  // ----------------------------------------
  // Einfacher Monatskalender mit Popup
  // ----------------------------------------

  const calendarGrid = document.getElementById("calendarGrid");
  const monthTitle = document.getElementById("monthTitle");
  const dialog = document.getElementById("eventDialog");
  const eventTitle = document.getElementById("eventTitle");
  const eventDate = document.getElementById("eventDate");
  const eventDescription = document.getElementById("eventDescription");

  let currentDate = new Date();

  // Monat rendern
  function renderCalendar(date = new Date()) {
    const year = date.getFullYear();
    const month = date.getMonth();

    const monthNames = [
      "Januar","Februar","März","April","Mai","Juni",
      "Juli","August","September","Oktober","November","Dezember"
    ];
    monthTitle.textContent = ${monthNames[month]} ${year};

    const firstDay = new Date(year, month, 1);
    const startDay = (firstDay.getDay() + 6) % 7; // Montag = 0
    const daysInMonth = new Date(year, month + 1, 0).getDate();

    let html = "";

    // Leere Zellen vor Monatsanfang
    for (let i = 0; i < startDay; i++) {
      html += <div class="cell empty"></div>;
    }

    // Tage des Monats
    for (let d = 1; d <= daysInMonth; d++) {
      html += `
        <div class="cell" data-day="${d}">
          <div class="date">${d}.</div>
        </div>`;
    }

    calendarGrid.innerHTML = html;
  }

  // Klick auf Tag -> Popup
  calendarGrid.addEventListener("click", (e) => {
    const cell = e.target.closest(".cell");
    if (!cell || cell.classList.contains("empty")) return;

    const day = cell.dataset.day;
    const monthName = monthTitle.textContent;

    eventTitle.textContent = Beispieltermin am ${day}.;
    eventDate.textContent = ${day}. ${monthName};
    eventDescription.textContent = "Dies ist eine Vorschau auf einen Beispieltermin.";
    dialog.classList.add("open");
  });

  // Popup schließen
  function closeDialog() {
    dialog.classList.remove("open");
  }

  // Monat wechseln
  document.getElementById("prevBtn").onclick = () => {
    currentDate.setMonth(currentDate.getMonth() - 1);
    renderCalendar(currentDate);
  };
  document.getElementById("nextBtn").onclick = () => {
    currentDate.setMonth(currentDate.getMonth() + 1);
    renderCalendar(currentDate);
  };

  // Initial laden
  renderCalendar(currentDate);
</script>
