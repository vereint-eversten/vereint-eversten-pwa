<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title data-i18n="home.metaTitle">Verein[t] ‚Äì Schule. Basketball. F√ºr Alle.</title>

  <!-- PWA -->
  <link rel="manifest" href="/manifest.webmanifest">
  <meta name="theme-color" content="#0b0b0b">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="/assets/pwa/icon-192.png">
  <meta name="app-build" content="2025-10-17">

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () =>
        navigator.serviceWorker.register('/sw.js').catch(() => {})
      );
    }
  </script>

  <!-- Basis Styles -->
  <link rel="stylesheet" href="/style.css">

  <!-- Fallback Styles (wenn /style.css fehlt) -->
  <style>
    body{background:#0b0b0b;color:#eaeaea;font-family:system-ui,-apple-system,Roboto,Inter,Arial,sans-serif;margin:0}
    main{padding:16px 16px 96px}
    .card{padding:16px;border:1px solid #1f1f1f;border-radius:12px;background:#111;margin-top:16px}
    .muted{color:#9aa0a6}
    .topbar{position:sticky;top:0;display:flex;align-items:center;justify-content:space-between;height:56px;padding:0 12px;background:rgba(10,10,10,.9);border-bottom:1px solid #1e1e1e}
    .icon-btn{display:inline-flex;align-items:center;gap:8px;height:36px;padding:0 10px;border-radius:999px;border:1px solid #1f1f1f;background:#141414;color:#fff;text-decoration:none}
    .bottom-nav{position:fixed;left:0;right:0;bottom:0;height:64px;background:rgba(10,10,10,.95);border-top:1px solid #1e1e1e;display:flex;gap:.25rem;padding:6px 8px;z-index:9999}
    .bottom-nav .nav-item{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;color:#eaeaea;text-decoration:none;font-size:.72rem;gap:6px;opacity:.8}
    .bottom-nav .nav-item.active{font-weight:700;opacity:1}
    .bottom-nav .nav-icon{width:22px;height:22px;fill:currentColor}
  </style>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.js"></script>

  <!-- üåç i18n -->
  <script>
  // --- Simple i18n Core ---
  const i18n = {
    currentLang: 'de',
    translations: {},
    async load(lang) {
      try {
        const res = await fetch(/assets/i18n/${lang}.json);
        if (!res.ok) throw new Error('missing');
        i18n.translations = await res.json();
        i18n.currentLang = lang;
        i18n.applyTranslations();
        localStorage.setItem('lang', lang);
      } catch(e) {
        console.warn('Translation load failed', e);
      }
    },
    applyTranslations(root=document){
      root.querySelectorAll('[data-i18n]').forEach(el=>{
        const key = el.dataset.i18n;
        const val = i18n.translations[key];
        if (val) el.textContent = val;
      });
    },
    detectLang(){
      return localStorage.getItem('lang') ||
             navigator.language.split('-')[0] ||
             'de';
    }
  };
  </script>

</head>
<body>
  <!-- üîù Top-Bar -->
  <header class="topbar">
    <div class="left">
      <a class="icon-btn" id="donateBtn" href="/donate/"><span>üéÅ</span><span data-i18n="nav.donateContact">Donate / Contact</span></a>
    </div>
    <div class="title" data-i18n="home.appName">Verein[t]</div>
    <div class="right">
      <a class="icon-btn" href="/settings/"><span>‚öô</span><span data-i18n="nav.settings">Einstellungen</span></a>
    </div>
  </header>

  <!-- üè† Hauptinhalt -->
  <main>
    <section class="card">
      <h1 data-i18n="home.title">Willkommen bei Verein[t]</h1>
      <p class="muted" data-i18n="home.subtitle">Schule. Basketball. F√ºr Alle.</p>
    </section>

    <section class="card">
      <h2 data-i18n="home.nextEvents.title">üóì N√§chste Termine</h2>
      <p data-i18n="home.nextEvents.text">√úbersicht der kommenden Events aus dem Kalender-Modul.</p>
    </section>

    <section class="card">
      <h2 data-i18n="home.lastMessages.title">üí¨ Letzte Nachrichten</h2>
      <p data-i18n="home.lastMessages.text">Neue Chat-Nachrichten aus deinen Teams.</p>
    </section>

    <section class="card">
      <h2 data-i18n="home.network.title">üåê Netzwerk</h2>
      <p data-i18n="home.network.text">Partner, Schulen & F√∂rderer auf einen Blick.</p>
    </section>
  </main>

  <!-- üîΩ Bottom Navigation -->
  <nav class="bottom-nav">
    <a class="nav-item" href="/" data-id="home">
      <svg class="nav-icon" viewBox="0 0 24 24"><path d="M4 10l8-6 8 6v8a2 2 0 0 1-2 2h-3v-6H9v6H6a2 2 0 0 1-2-2z"/></svg>
      <span data-i18n="nav.home">Home</span>
    </a>
    <a class="nav-item" href="/project/" data-id="project">
      <svg class="nav-icon" viewBox="0 0 24 24"><path d="M4 4h16v4H4zM4 10h16v10H4z"/></svg>
      <span data-i18n="nav.project">Projekt</span>
    </a>
    <a class="nav-item" href="/calendar/" data-id="calendar">
      <svg class="nav-icon" viewBox="0 0 24 24"><path d="M7 2v3M17 2v3M3 9h18M5 12h4M11 12h4M17 12h2M5 16h6"/></svg>
      <span data-i18n="nav.calendar">Kalender</span>
    </a>
    <a class="nav-item" href="/messenger/" data-id="messenger">
      <svg class="nav-icon" viewBox="0 0 24 24"><path d="M4 19l2-5 6-3 6 3-2 5-4 2zM6 6h12"/></svg>
      <span data-i18n="nav.messenger">Messenger</span>
    </a>
  </nav>

  <!-- ‚öô Script: Sprache + Navigation -->
  <script>
    (async function(){
      // Sprache laden
      const lang = i18n.detectLang();
      await i18n.load(lang);

      // Aktiven Navigationspunkt markieren
      const path = location.pathname.replace(/\/+$/, '') || '/';
      document.querySelectorAll('.bottom-nav .nav-item').forEach(a=>{
        const href = a.getAttribute('href').replace(/\/+$/, '') || '/';
        if ((href === '/' && path === '/') || (href !== '/' && path.startsWith(href))){
          a.classList.add('active');
        }
      });

      // Donate/Contact nur auf Home anzeigen
      const donate = document.getElementById('donateBtn');
      if (donate) donate.style.display = (path === '/') ? '' : 'none';
    })();
  </script>
</body>
</html>
