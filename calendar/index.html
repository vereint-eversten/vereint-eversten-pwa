<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title data-i18n="calendar.title">Kalender – Verein[t]</title>

  <!-- PWA -->
  <link rel="manifest" href="/manifest.webmanifest">
  <meta name="theme-color" content="#0b0b0b">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="/assets/pwa/icon-192.png">
  <meta name="app-build" content="2025-10-16">

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function () {
        navigator.serviceWorker.register('/sw.js').catch(function(){});
      });
    }
  </script>

  <!-- Styles -->
  <link rel="stylesheet" href="/style.css">

  <!-- i18n (Reihenfolge wichtig) -->
  <script defer src="/assets/js/languages.js"></script>
  <script defer src="/assets/js/i18n.js"></script>
  <script defer src="/assets/js/lang-toggle.js"></script>

  <!-- Bottom Navigation -->
  <script defer src="/assets/js/nav.js"></script>

  <!-- Modul-spezifische Styles -->
  <style>
    .calendar{ padding:16px }
    .calendar .top{ display:flex; align-items:center; gap:12px; flex-wrap:wrap; margin-bottom:1rem }
    .calendar select, .calendar button{
      background:#111; color:#eee; border:1px solid #333; border-radius:6px; padding:6px 10px; font-size:.9rem
    }
    .calendar button:hover{ background:#222 }
    .calendar .grid{ display:grid; grid-template-columns:repeat(7,1fr); gap:6px }
    .calendar .cell{ padding:8px; border:1px solid #222; border-radius:6px; min-height:76px }
    .calendar .date{ font-weight:600; margin-bottom:6px; color:#eaeaea }
    .event{ background:#1a1a1a; border:1px solid #2a2a2a; border-radius:6px; padding:6px; margin-top:6px; cursor:pointer }
    .event:hover{ background:#222 }

    .dialog{ position:fixed; inset:0; background:rgba(0,0,0,.6); display:none; align-items:center; justify-content:center; z-index:10000 }
    .dialog.open{ display:flex }
    .dialog .card{ background:#111; border-radius:12px; padding:20px; max-width:420px; width:90%; color:#fff; position:relative; border:1px solid #222 }
    .dialog .close-btn{ position:absolute; right:10px; top:10px; background:none; border:0; color:#fff; font-size:1.4rem; cursor:pointer }
    .dialog .button{ background:var(--accent,#2ea44f); color:#fff; text-decoration:none; padding:8px 12px; border-radius:6px; display:inline-block }
    .dialog .button:hover{ opacity:.9 }
  </style>
</head>

<body>
  <main>
    <section class="calendar">
      <div class="top">
        <button id="prevBtn" data-i18n-attr="aria-label:calendar.prev" aria-label="Vorheriger Monat">‹</button>
        <h2 id="monthTitle" style="margin:0; font-size:18px;" data-i18n="calendar.month">Monat</h2>
        <button id="nextBtn" data-i18n-attr="aria-label:calendar.next" aria-label="Nächster Monat">›</button>

        <div style="margin-left:auto; display:flex; gap:8px; align-items:center;">
          <select id="gradeFilter" data-i18n-attr="aria-label:calendar.filter.grade" aria-label="Klassenstufe">
            <option value="" data-i18n="calendar.filters.allGrades">Alle Klassen</option>
          </select>

          <select id="typeFilter" data-i18n-attr="aria-label:calendar.filter.type" aria-label="Art der Veranstaltung">
            <option value="" data-i18n="calendar.filters.allTypes">Alle Arten</option>
          </select>

          <select id="ageFilter" data-i18n-attr="aria-label:calendar.filter.age" aria-label="Alter">
            <option value="" data-i18n="calendar.filters.allAges">Alle Altersgruppen</option>
          </select>
        </div>
      </div>

      <!-- Raster -->
      <div id="calendarGrid" class="grid" aria-live="polite"></div>
    </section>

    <!-- Dialog -->
    <div class="dialog" id="eventDialog" role="dialog" aria-modal="true" aria-labelledby="eventTitle">
      <div class="card">
        <button class="close-btn" onclick="closeCalendarDialog()" aria-label="Schließen">×</button>

        <h3 id="eventTitle">Titel</h3>
        <p id="eventDate" class="muted"></p>
        <p id="eventDescription"></p>

        <hr style="margin:16px 0; border:1px solid var(--border,#333)">

        <p style="text-align:center;">
          <a href="/project/anmeldung.html" id="eventSignupLink" class="button" data-i18n="calendar.signup">➕ Zur Anmeldung</a>
        </p>
      </div>
    </div>
  </main>

  <!-- Kalenderlogik -->
  <script src="/assets/js/kalender.js"></script>
</body>
</html>
